---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import Hero from "../sections/homepage/Hero.astro";
import Prose from "../components/Prose.astro";
import Content from "../components/Content.astro";
import Cards from "../components/Cards.astro";
import Card from "../components/Card.astro";

import HowWeWork from "../sections/homepage/how_we_work.md";
import ContactForm from "../sections/homepage/ContactForm.astro";

// These are configured as a collection in src/content/config.ts
// That may prove overkill just for cards; we'll see how it goes.
const cards = (await getCollection("cards")).sort((a, b) =>
  a.slug.localeCompare(b.slug)
);
---

<Layout>
  <Hero />
  <Content border>
    <Prose>
      <HowWeWork />
    </Prose>
  </Content>
  <Content border className="bg-neutral-100">
    <Prose>
      <h2 id="what-we-offer">What we offer</h2>
      <Cards>
        {
          cards.map(async (card) => {
            const { Content: CardContent } = await card.render();
            return (
              <Card {...card.data}>
                <CardContent />
              </Card>
            );
          })
        }
      </Cards>
    </Prose>
  </Content>
  <Content border>
    <ContactForm />
  </Content>
</Layout>
